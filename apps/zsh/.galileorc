alias galileocfg="code -nw ~/.galileorc"

# Galileo auto-bootstraping
DOTFILES_DIR=~/workspace/galileo/dotfiles
if [ -d "$DOTFILES_DIR/.git" ]; then
  CURRENT_BRANCH=$(git -C "$DOTFILES_DIR" rev-parse --abbrev-ref HEAD 2>/dev/null)
  if [ "$CURRENT_BRANCH" != "master" ]; then
    echo "⚠️  Galileo dotfiles not on master branch (currently on: $CURRENT_BRANCH)" >&2
  elif ! git -C "$DOTFILES_DIR" diff-index --quiet HEAD -- 2>/dev/null; then
    echo "⚠️  Galileo dotfiles has local changes, skipping auto-update" >&2
  else
    git -C "$DOTFILES_DIR" pull > /dev/null 2>&1
  fi
fi

# Source library functions from bootstrap
if [ -f "$DOTFILES_DIR/bootstrap.sh" ]; then
  source "$DOTFILES_DIR/bootstrap.sh"
fi

# Auto-refresh AWS CodeArtifact if token is expired (>11 hours old)
if [[ -f ~/.config/pip/pip.conf ]]; then
  pip_age=$(($(date +%s) - $(stat -f %m ~/.config/pip/pip.conf)))
  if (( pip_age > 39600 )); then
    echo "Refreshing AWS CodeArtifact credentials..."
    aws-codeartifact
  fi
fi

# Directories
export gal=~/workspace/galileo/
export galileo=~/workspace/galileo/
export sandbox=~/workspace/galileo/sandbox/
export projects=~/workspace/galileo/sandbox/

# Core projects
export gdots=~/workspace/galileo/dotfiles/

# Services
export core=~/workspace/galileo/core-api/
export coreapi=~/workspace/galileo/core-api/
export api=~/workspace/galileo/api/

# Clients
export ios=~/workspace/galileo/health-ios/
export android=~/workspace/galileo/health-android/
export android=~/workspace/galileo/frontend-monorepo/
export web=~/workspace/galileo/health-web/

# dbt
alias dbt="python3 -m dbt.cli.main"

